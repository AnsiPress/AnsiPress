---
# Setup Ubuntu Repository

- name: Adding NGINX Repository Key, Hold on...
  apt_key:
    id: B9C9F7DE
    url: http://download.opensuse.org/repositories/home:AnsiPress/x{{ ansible_distribution }}_{{ ansible_distribution_version }}/Release.key
  register: apt_key
  when: ansible_distribution == 'Ubuntu'

- name: Adding NGINX Repository, Hold on...
  apt_repository: repo='deb http://download.opensuse.org/repositories/home:/AnsiPress/x{{ ansible_distribution }}_{{ ansible_distribution_version }}/ /' state=present filename=nginx
  register: repository
  when: ansible_distribution == 'Ubuntu'

- name: Adding PHP Repository, Hold on...
  apt_repository: repo=ppa:ondrej/php
  register: repository

- name: Adding MariaDB Repository Key, Hold on...
  apt_key: keyserver=keyserver.ubuntu.com id=0xF1656F24C74CD1D8
  register: apt_key

- name: Adding MariaDB Repository, Hold on...
  apt_repository: repo='deb [arch=amd64,i386,ppc64el] http://nyc2.mirrors.digitalocean.com/mariadb/repo/10.1/{{ ansible_distribution | lower }} {{ ansible_distribution_release }} main' state=present filename=mariadb
  register: repository

- include: roles/libs/tasks/apt/update.yml
  when: repository.changed == True or apt_key.changed == True
